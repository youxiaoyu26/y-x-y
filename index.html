<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§å§çš„ç§äººåŠ¨æ€ç©ºé—´</title>
    <style>
        :root { --main: #d4a373; --bg: #faf9f6; --danger: #ff4d4d; --white: #ffffff; }
        body { background: var(--bg); font-family: 'PingFang SC', sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
        
        /* å¯¼èˆªæ  */
        header { 
            position: fixed; top: 0; width: 100%; height: 60px; 
            background: rgba(255,255,255,0.85); backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 20px; box-sizing: border-box; z-index: 1000; border-bottom: 1px solid #eee;
        }
        .logo { color: var(--main); font-weight: bold; letter-spacing: 1px; }

        /* ä¸‰æ¡æ èœå•æŒ‰é’® */
        .menu-btn { cursor: pointer; border: none; background: none; display: flex; flex-direction: column; gap: 5px; z-index: 2001; padding: 10px; }
        .menu-btn span { width: 25px; height: 2px; background: var(--main); border-radius: 2px; transition: 0.3s; }

        /* ä¾§è¾¹æ  */
        #sidePanel {
            position: fixed; top: 0; right: -300px; width: 280px; height: 100%;
            background: var(--white); z-index: 2000; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 80px 30px; box-sizing: border-box; box-shadow: -5px 0 15px rgba(0,0,0,0.05);
        }
        #sidePanel.open { right: 0; }

        .info-section { margin-bottom: 30px; }
        .info-label { color: #999; font-size: 12px; letter-spacing: 1px; margin-bottom: 8px; display: block; border-bottom: 1px solid #f5f5f5; padding-bottom: 5px; }
        .info-content { color: #333; font-size: 14px; line-height: 1.6; }

        /* ä¸»ä½“å†…å®¹åŒº */
        .container { max-width: 500px; margin: 90px auto 50px; padding: 0 20px; }
        #tips { text-align: center; color: var(--main); font-size: 13px; margin-bottom: 15px; min-height: 20px; }

        .input-area { background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); margin-bottom: 25px; }
        textarea { width: 100%; height: 85px; border: 1px solid #eee; border-radius: 10px; padding: 12px; box-sizing: border-box; font-size: 16px; outline: none; resize: none; transition: 0.3s; }
        textarea:focus { border-color: var(--main); }
        .btn-send { width: 100%; background: var(--main); color: white; border: none; padding: 12px; border-radius: 10px; margin-top: 10px; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s; }
        .btn-send:active { transform: scale(0.98); opacity: 0.9; }

        /* åŠ¨æ€å¡ç‰‡ */
        .card { background: #fff; padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--main); box-shadow: 0 2px 5px rgba(0,0,0,0.02); position: relative; }
        .time { font-size: 11px; color: #bbb; display: block; margin-bottom: 8px; }
        .content { color: #444; font-size: 16px; line-height: 1.5; white-space: pre-wrap; word-break: break-all; }
        
        /* åˆ é™¤æŒ‰é’® */
        .btn-del { 
            background: none; border: 1px solid #f5f5f5; color: #ddd; 
            padding: 2px 10px; border-radius: 5px; cursor: pointer; font-size: 11px;
            float: right; margin-top: 10px; transition: 0.3s;
        }
        .btn-del:hover { color: var(--danger); border-color: var(--danger); }

        /* é®ç½©å±‚ */
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.2); display: none; z-index: 1999; backdrop-filter: blur(2px); }
        
        /* åˆ·æ–°æŒ‰é’® */
        .refresh-btn { position: fixed; bottom: 30px; right: 20px; background: #fff; border: 1px solid var(--main); color: var(--main); width: 50px; height: 50px; border-radius: 25px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); font-size: 12px; z-index: 100; }
    </style>
</head>
<body>

    <header>
        <div class="logo">FOR SISTER</div>
        <div class="menu-btn" onclick="toggleMenu()">
            <span></span><span></span><span></span>
        </div>
    </header>

    <div id="overlay" onclick="toggleMenu()"></div>

    <div id="sidePanel">
        <div class="info-section">
            <span class="info-label">ğŸ“¢ å…¬å‘Š</span>
            <div class="info-content">æ¬¢è¿æ¥åˆ°å§å§çš„ç§˜å¯†åŸºåœ°ï¼åœ¨è¿™é‡Œè®°å½•çš„æ¯ä¸€å¥è¯ï¼Œéƒ½ä¼šæ°¸è¿œä¿å­˜åœ¨äº‘ç«¯ã€‚æ„¿å§å§å¤©å¤©å¼€å¿ƒï¼Œå¥½æ¢¦å¸¸åœ¨ï¼</div>
        </div>
        <div class="info-section">
            <span class="info-label">ğŸ‘¤ å…³äºä½œè€…</span>
            <div class="info-content">æ¥è‡ªæœ€æ”¯æŒä½ çš„å®¶äºº<br>Gemini Collaborative Design</div>
        </div>
        <div class="info-section">
            <span class="info-label">ğŸ”– ç‰ˆæœ¬ä¿¡æ¯</span>
            <div class="info-content">v5.1.0 (Stable Cloud)</div>
        </div>
    </div>

    <div class="container">
        <div id="tips">æ­£åœ¨æ£€æŸ¥åŒæ­¥è¿æ¥...</div>

        <div class="input-area">
            <textarea id="myMsg" placeholder="å†™ä¸‹æƒ³å¯¹å§å§è¯´çš„è¯..."></textarea>
            <button class="btn-send" id="pubBtn" onclick="publish()">åŒæ­¥å‘å¸ƒ</button>
        </div>

        <div id="msgList"></div>
    </div>

    <button class="refresh-btn" onclick="loadData()">åˆ·æ–°</button>

    <script>
        // ================= é…ç½®åŒº =================
        const MY_KEY = "$2a$10$lq61umlvFUgmbzVZts9WY.4brTae7F8gCucq2L47zNSOKa4WRKODO"; 
        const MY_ID = "699c4b22ae596e708f424292"; 
        const ADMIN_PASSWORD = "123"; // è®¾ç½®ä½ çš„åˆ é™¤å¯†ç 
        // ==========================================

        function toggleMenu() {
            const panel = document.getElementById('sidePanel');
            const overlay = document.getElementById('overlay');
            const isOpen = panel.classList.toggle('open');
            overlay.style.display = isOpen ? 'block' : 'none';
        }

        async function loadData() {
            if(MY_KEY.includes("$2a$10$lq61umlvFUgmbzVZts9WY.4brTae7F8gCucq2L47zNSOKa4WRKODO") || MY_ID.includes("699c4b22ae596e708f424292")) {
                document.getElementById('tips').innerText = "âŒ è¯·å…ˆé…ç½® Key å’Œ ID";
                return;
            }
            document.getElementById('tips').innerText = "æ­£åœ¨ä»äº‘ç«¯è·å–æœ€æ–°åŠ¨æ€...";
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY, "Cache-Control": "no-cache" }
                });
                const data = await res.json();
                render(data.record.notes || []);
                document.getElementById('tips').innerText = "âœ¨ äº‘ç«¯æ•°æ®åŒæ­¥å®Œæˆ";
            } catch (e) {
                document.getElementById('tips').innerText = "âŒ è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
            }
        }

        function render(notes) {
            const list = document.getElementById('msgList');
            list.innerHTML = '';
            // å€’åºï¼šæœ€æ–°çš„åœ¨æœ€ä¸Šé¢ã€‚realIndex ç¡®ä¿åˆ é™¤æ—¶å¯¹åº”åŸæ•°ç»„ä½ç½®
            [...notes].reverse().forEach((n, reverseIndex) => {
                const realIndex = notes.length - 1 - reverseIndex;
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <span class="time">${n.time}</span>
                    <div class="content">${n.content}</div>
                    <button class="btn-del" onclick="deleteNote(${realIndex})">åˆ é™¤</button>
                    <div style="clear:both"></div>
                `;
                list.appendChild(div);
            });
        }

        async function publish() {
            const txt = document.getElementById('myMsg').value.trim();
            if(!txt) return;
            const btn = document.getElementById('pubBtn');
            btn.disabled = true;
            document.getElementById('tips').innerText = "æ­£åœ¨ä¸Šä¼ åˆ°äº‘ç«¯...";

            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY }
                });
                const data = await res.json();
                let notes = data.record.notes || [];
                notes.push({ content: txt, time: new Date().toLocaleString() });
                
                await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}`, {
                    method: 'PUT',
                    headers: { "Content-Type": "application/json", "X-Master-Key": MY_KEY },
                    body: JSON.stringify({ notes: notes })
                });

                document.getElementById('myMsg').value = '';
                loadData();
            } catch (e) {
                alert("å‘å¸ƒå¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");
            } finally {
                btn.disabled = false;
            }
        }

        async function deleteNote(index) {
            const pw = prompt("è¯·è¾“å…¥ç®¡ç†å¯†ç ç¡®è®¤åˆ é™¤ï¼š");
            if (pw === null) return;
            if (pw !== ADMIN_PASSWORD) {
                alert("å¯†ç é”™è¯¯ï¼Œæ— æ³•åˆ é™¤åŠ¨æ€");
                return;
            }

            document.getElementById('tips').innerText = "æ­£åœ¨é”€æ¯äº‘ç«¯æ•°æ®...";
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY }
                });
                const data = await res.json();
                let notes = data.record.notes || [];
                notes.splice(index, 1);
                
                await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}`, {
                    method: 'PUT',
                    headers: { "Content-Type": "application/json", "X-Master-Key": MY_KEY },
                    body: JSON.stringify({ notes: notes })
                });
                loadData();
            } catch (e) {
                alert("åˆ é™¤å¤±è´¥");
            }
        }

        window.onload = loadData;
    </script>
</body>
</html>
