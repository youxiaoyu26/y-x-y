<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§å§çš„ç§äººåŠ¨æ€ç©ºé—´</title>
    <style>
        :root { --main: #d4a373; --bg: #faf9f6; --danger: #ff4d4d; --white: #ffffff; }
        body { background: var(--bg); font-family: 'PingFang SC', sans-serif; margin: 0; padding: 0; }
        
        /* å¯¼èˆªæ  */
        header { 
            position: fixed; top: 0; width: 100%; height: 60px; 
            background: rgba(255,255,255,0.85); backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 20px; box-sizing: border-box; z-index: 1000; border-bottom: 1px solid #eee;
        }

        /* ä¸‰æ¡æ æŒ‰é’® */
        .menu-btn { cursor: pointer; border: none; background: none; display: flex; flex-direction: column; gap: 5px; z-index: 2001; }
        .menu-btn span { width: 25px; height: 2px; background: var(--main); border-radius: 2px; transition: 0.3s; }

        /* ä¾§è¾¹æ  */
        #sidePanel {
            position: fixed; top: 0; right: -300px; width: 280px; height: 100%;
            background: var(--white); z-index: 2000; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 80px 30px; box-sizing: border-box; box-shadow: -5px 0 15px rgba(0,0,0,0.05);
        }
        #sidePanel.open { right: 0; }

        .info-section { margin-bottom: 30px; }
        .info-label { color: #999; font-size: 12px; letter-spacing: 1px; margin-bottom: 8px; display: block; }
        .info-content { color: #333; font-size: 14px; line-height: 1.6; }

        /* ä¸»ä½“å†…å®¹ */
        .container { max-width: 500px; margin: 100px auto 50px; padding: 0 20px; }
        #tips { text-align: center; color: var(--main); font-size: 13px; margin-bottom: 15px; min-height: 20px; }

        .input-area { background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); margin-bottom: 30px; }
        textarea { width: 100%; height: 80px; border: 1px solid #eee; border-radius: 10px; padding: 10px; box-sizing: border-box; font-size: 16px; outline: none; resize: none; }
        .btn-send { width: 100%; background: var(--main); color: white; border: none; padding: 12px; border-radius: 10px; margin-top: 10px; cursor: pointer; font-size: 16px; font-weight: bold; }

        .card { background: #fff; padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--main); box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .time { font-size: 12px; color: #bbb; display: block; margin-bottom: 8px; }
        .content { color: #444; font-size: 16px; line-height: 1.5; white-space: pre-wrap; word-break: break-all; }
        
        .btn-del { 
            background: none; border: 1px solid #f0f0f0; color: #ccc; 
            padding: 3px 10px; border-radius: 5px; cursor: pointer; font-size: 11px;
            float: right; margin-top: 10px;
        }
        .btn-del:hover { color: var(--danger); border-color: var(--danger); }

        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.1); display: none; z-index: 1999; }
        .refresh-btn { position: fixed; bottom: 30px; right: 20px; background: #fff; border: 1px solid var(--main); color: var(--main); width: 50px; height: 50px; border-radius: 25px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); font-size: 12px; }
    </style>
</head>
<body>

    <header>
        <div style="color: var(--main); font-weight: bold;">FOR SISTER</div>
        <div class="menu-btn" onclick="toggleMenu()">
            <span></span><span></span><span></span>
        </div>
    </header>

    <div id="overlay" onclick="toggleMenu()"></div>

    <div id="sidePanel">
        <div class="info-section">
            <span class="info-label">ğŸ“¢ å…¬å‘Š</span>
            <div class="info-content">æ¬¢è¿æ¥åˆ°å§å§çš„ç§˜å¯†åŸºåœ°ï¼åœ¨è¿™é‡Œè®°å½•çš„æ¯ä¸€å¥è¯ï¼Œéƒ½ä¼šæ°¸è¿œä¿å­˜åœ¨äº‘ç«¯ã€‚æ„¿å§å§å¤©å¤©å¼€å¿ƒï¼</div>
        </div>
        <div class="info-section">
            <span class="info-label">ğŸ‘¤ ä½œè€…</span>
            <div class="info-content">æ¥è‡ªæœ€æ”¯æŒä½ çš„å®¶äºº</div>
        </div>
        <div class="info-section">
            <span class="info-label">ğŸ”– ç‰ˆæœ¬</span>
            <div class="info-content">v1.0.3 (Cloud & Secure)</div>
        </div>
    </div>

    <div class="container">
        <div id="tips">æ­£åœ¨è¿æ¥äº‘ç«¯...</div>

        <div class="input-area">
            <textarea id="myMsg" placeholder="å†™ä¸‹æƒ³å¯¹å§å§è¯´çš„è¯..."></textarea>
            <button class="btn-send" id="pubBtn" onclick="publish()">å‘å¸ƒå†…å®¹</button>
        </div>

        <div id="msgList"></div>
    </div>

    <button class="refresh-btn" onclick="loadData()">åˆ·æ–°</button>

    <script>
        // ================= é…ç½®åŒº =================
        const MY_KEY = "$2a$10$lq61umlvFUgmbzVZts9WY.4brTae7F8gCucq2L47zNSOKa4WRKODO"; 
        const MY_ID = "699c4b22ae596e708f424292"; 
        const ADMIN_PASSWORD = "ä½œè€…æ˜¯å¸…å“¥"; // è¿™é‡Œè®¾ç½®åˆ é™¤å¯†ç 
        // ==========================================

        function toggleMenu() {
            const panel = document.getElementById('sidePanel');
            const overlay = document.getElementById('overlay');
            const isOpen = panel.classList.toggle('open');
            overlay.style.display = isOpen ? 'block' : 'none';
        }

        async function loadData() {
            if(MY_KEY.includes("$2a$10$lq61umlvFUgmbzVZts9WY.4brTae7F8gCucq2L47zNSOKa4WRKODO") || MY_ID.includes("è¿™é‡Œ")) {
                document.getElementById('tips').innerText = "âŒ è¯·å…ˆé…ç½® Key å’Œ ID";
                return;
            }
            document.getElementById('tips').innerText = "æ­£åœ¨åŒæ­¥å†…å®¹...";
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY }
                });
                const data = await res.json();
                render(data.record.notes || []);
                document.getElementById('tips').innerText = "âœ¨ äº‘ç«¯åŒæ­¥å·²å®Œæˆ";
            } catch (e) {
                document.getElementById('tips').innerText = "âŒ è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
            }
        }

        function render(notes) {
            const list = document.getElementById('msgList');
            list.innerHTML = '';
            // å€’åºæ˜¾ç¤ºï¼Œæœ€æ–°åœ¨ä¸Šé¢
            [...notes].reverse().forEach((n, reverseIndex) => {
                // è®¡ç®—åœ¨åŸæ•°ç»„ä¸­çš„çœŸå®ç´¢å¼•
                const realIndex = notes.length - 1 - reverseIndex;
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <span class="time">${n.time}</span>
                    <div class="content">${n.content}</div>
                    <button class="btn-del" onclick="deleteNote(${realIndex})">åˆ é™¤</button>
                    <div style="clear:both"></div>
                `;
                list.appendChild(div);
            });
        }

        async function publish() {
            const txt = document.getElementById('myMsg').value.trim();
            if(!txt) return;
            const btn = document.getElementById('pubBtn');
            btn.disabled = true;

            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY }
                });
                const data = await res.json();
                let notes = data.record.notes || [];
                notes.push({ content: txt, time: new Date().toLocaleString() });
                
                await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}`, {
                    method: 'PUT',
                    headers: { "Content-Type": "application/json", "X-Master-Key": MY_KEY },
                    body: JSON.stringify({ notes: notes })
                });

                document.getElementById('myMsg').value = '';
                loadData();
            } catch (e) {
                alert("å‘å¸ƒå¤±è´¥");
            } finally {
                btn.disabled = false;
            }
        }

        async function deleteNote(index) {
            const pw = prompt("è¯·è¾“å…¥ç®¡ç†å¯†ç ï¼š");
            if (pw === null) return;
            if (pw !== ADMIN_PASSWORD) {
                alert("å¯†ç é”™è¯¯ï¼");
                return;
            }

            document.getElementById('tips').innerText = "æ­£åœ¨ä»äº‘ç«¯ç§»é™¤...";
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}/latest`, {
                    headers: { "X-Master-Key": MY_KEY }
                });
                const data = await res.json();
                let notes = data.record.notes || [];
                notes.splice(index, 1);
                
                await fetch(`https://api.jsonbin.io/v3/b/${MY_ID}`, {
                    method: 'PUT',
                    headers: { "Content-Type": "application/json", "X-Master-Key": MY_KEY },
                    body: JSON.stringify({ notes: notes })
                });
                loadData();
            } catch (e) {
                alert("åˆ é™¤å¤±è´¥");
            }
        }

        window.onload = loadData;
    </script>
</body>
</html>
